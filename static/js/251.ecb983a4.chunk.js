"use strict";(globalThis.webpackChunkvocechat_web=globalThis.webpackChunkvocechat_web||[]).push([[251],{41758:(e,a,t)=>{t.d(a,{A:()=>n});var s=t(45646);const n=({children:e,className:a="",...t})=>(0,s.jsx)("label",{className:`text-gray-800 dark:text-gray-100 text-sm font-semibold ${a}`,...t,children:e})},44038:(e,a,t)=>{t.d(a,{A:()=>i});var s,n=t(91118);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var s in t)({}).hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},l.apply(null,arguments)}const r=({title:e,titleId:a,...t},r)=>n.createElement("svg",l({width:16,height:16,viewBox:"0 0 16 16",stroke:"black",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:r,"aria-labelledby":a},t),e?n.createElement("title",{id:a},e):null,s||(s=n.createElement("path",{d:"M10 4L6 8L10 12",strokeOpacity:.8,strokeLinecap:"round",strokeLinejoin:"round"}))),i=(0,n.forwardRef)(r)},92251:(e,a,t)=>{t.r(a),t.d(a,{default:()=>A});var s=t(91118),n=t(90184),l=t(23558),r=t(32639),i=t(56966),o=t(69259),c=t(28512),d=t(76013),u=t(68702),m=t(71040),g=t(41758),x=t(44038),h=t(86938),p=t(45646);function f({email:e}){const a=(0,h.Zp)();return(0,p.jsx)(u.A,{className:"w-full ghost",onClick:()=>{a(`/send_magic_link/${e}`)},children:"Sign in with a Magic Link"})}function w(){const{t:e}=(0,l.Bd)("auth"),a=(0,h.Zp)();return(0,p.jsxs)("div",{className:"flex gap-1 mt-7 text-sm text-slate-500 dark:text-gray-100 justify-center",children:[(0,p.jsx)("span",{children:e("login.no_account")}),(0,p.jsx)("a",{className:"text-primary-400 cursor-pointer",onClick:()=>{a("/register")},children:e("sign_up")})]})}var j=t(21153),y=t(31210),b=t(37638),k=t(213);const v={email:"",password:""};function A(){const{name:e,logo:a}=(0,c.GV)((e=>e.server),y.bN),{t:t}=(0,l.Bd)("auth"),{t:h}=(0,l.Bd)(),{data:A,isLoading:N}=(0,o.Q0)(),[_,{isSuccess:E,isLoading:L,error:S}]=(0,i._L)(),{data:C,isSuccess:O}=(0,o.T7)(),[R,P]=(0,s.useState)(!1),[$,B]=(0,s.useState)(v);(0,s.useEffect)((()=>{const e=new URLSearchParams(location.search),a=e.get("code"),t=e.get("state"),s=e.get("magic_token"),n=e.get("exists");if(a&&t&&_({code:a,state:t,type:"oidc"}),s&&"undefined"!==typeof n){"true"==n?_({magic_token:s,type:"magiclink"}):location.href=`/#/register/set_name/login?magic_token=${s}`}}),[]),(0,s.useEffect)((()=>{if(S)switch(S.status){case 401:case 404:n.Ay.error("Username or Password incorrect");break;case 403:n.Ay.error("Login method does not supported");break;case 410:n.Ay.error("No associated account found, please contact user admin for an invitation link to join.");break;case"PARSING_ERROR":break;default:n.Ay.error("Something Error")}else;}),[S]),(0,s.useEffect)((()=>{E&&n.Ay.success(h("tip.login"))}),[E]);const I=e=>{const{type:a}=e.target.dataset,{value:t}=e.target;if(!a)return;const s={...$,[a]:t};B(s)},{email:T,password:q}=$;if(!O)return null;const{magic_link:D,who_can_sign_up:G}=C,M=A&&D,U=M&&R||"InvitationOnly"==G,Z=!M||R;return N?null:(0,p.jsxs)("div",{className:"flex-center h-screen dark:bg-gray-700",children:[(0,p.jsxs)("div",{className:"relative py-8 px-10 shadow-md rounded-xl",children:[R&&(0,p.jsx)(x.A,{role:"button",className:"absolute left-7 top-8 w-10 h-10 stroke-gray-300",onClick:()=>{P(!1)}}),(0,p.jsxs)("div",{className:"flex-center flex-col pb-6 w-full",children:[(0,p.jsx)("img",{src:a||`${r.Ay}/resource/organization/logo?t=${Date.now()}`,alt:"logo",className:"w-14 h-14 mb-3 md:mb-7 rounded-full"}),(0,p.jsx)("h2",{className:"font-semibold text-center text-balance text-2xl max-w-[420px] text-gray-800 dark:text-white",children:t("login.title",{name:e})})]}),(0,p.jsxs)("form",{className:"flex flex-col gap-5 md:min-w-[360px] w-full",autoComplete:"false",onSubmit:e=>{e.preventDefault();A&&(null===C||void 0===C?void 0:C.magic_link)&&!R?P(!0):_({...$,type:"password"})},children:[!R&&(0,p.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,p.jsx)(g.A,{children:"Email"}),(0,p.jsx)(m.A,{autoFocus:!0,className:"large",name:"email",value:T,type:"email",required:!0,placeholder:t("placeholder_email"),"data-type":"email",onChange:I})]}),(!M||R)&&(0,p.jsxs)("div",{className:"",children:[(0,p.jsx)(g.A,{children:"Password"}),(0,p.jsx)(m.A,{className:"large",type:"password",value:q,name:"password",required:!0,"data-type":"password",onChange:I,placeholder:t("placeholder_pwd")})]}),Z?(0,p.jsx)(u.A,{type:"submit",disabled:L,children:L?"Signing":t("sign_in")}):(0,p.jsx)(u.A,{type:"submit",children:t("continue")})]}),(0,p.jsx)(d.A,{content:"OR"}),(0,p.jsxs)("div",{className:"socials flex flex-col gap-3",children:[R&&(0,p.jsx)(f,{email:$.email}),!U&&(0,p.jsx)(j.A,{})]}),"EveryOne"===G&&(0,p.jsx)(w,{}),(0,p.jsx)(k.A,{})]}),(0,p.jsx)(b.A,{})]})}}}]);